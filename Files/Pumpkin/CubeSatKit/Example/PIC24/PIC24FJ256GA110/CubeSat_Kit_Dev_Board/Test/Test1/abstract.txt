/****************************************************************************** 
(C)Copyright Pumpkin, Inc. Freely distributable.

$Source: C:\\RCS\\D\\Pumpkin\\CubeSatKit\\Example\\PIC24\\PIC24FJ256GA110\\CubeSat_Kit_Dev_Board\\Test\\Test1\\abstract.txt,v $
$Author: aek $
$Revision: 3.12 $
$Date: 2011-09-17 22:12:30-07 $

******************************************************************************/

*******************************************************************************

Test1 test/validation application for CubeSat Kits running with PIC24-based 
PPM D1s.

(C)Copyright Pumpkin, Inc. All Rights Reserved.

WARNING: The shutdown command ('z') of this application sets nearly all of the 
microcontroller's signals (and hence, signals on the CubeSat Kit bus) to be 
_outputs_. This permits validation of the current draw of the entire system 
when in sleep mode. However, this may lead to damage of circuitry attached via
the CubeSat Kit bus in cases where external circuitry drives singals that are
connected directly to the microcontroller (e.g., IO[47..0]). Therefore it is 
STRONGLY recommended that you remove any CubeSat Kit modules that drive signals 
onto the bus before using this application.

*******************************************************************************

BLOCK DIAGRAM:

             +------------+
             |    PC      |
             +------------+
                   ^
                   |
                   v
             +------------+
             | MPLAB ICD2 |
             +------------+
                   ^
                   |
                   v
             +------------+
  6-24Vdc    | JFPC-PIC24 |
    |        +------------+
    v              ^
  +----------------|----------------------------------------------------------+
  | J3             v                                                          |
  |         +-------------+      CubeSat Kit Development Board                |
  |         |   PPM D1    |                                                   |
  |         |     or      |                                                   |
  |         |   PSPM D    |                          +-------------------+    |
  |         +-------------+                          | MHX2400 or equiv. |    |
  |                                                  |    9600,N,8,1     |    |
  |                                                  +-------------------+    |   
  |                                                                           |   
  |                                                                           |   
  |                                                                           |   
  |                                                                           |   
  |                                                                           |   
  |     J8             J2                                                     |   
  +---------------------------------------------------------------------------+
        ^              ^
        |              |
        v              v
  +------------+ +------------+
  |     PC     | |     PC     |
  | 9600,N,8,1 | | 9600,N,8,1 |
  +------------+ +------------+
  
J8: connect via null-modem cable (DB9 receptacle on each end)
J2: connect via USB cable  

*******************************************************************************

PREREQUISITES:                                      Min. version

  Hardware:
    Pumpkin CubeSat Kit Development Board              Rev D
    Pumpkin PPM D1 or PSPM D w/PIC24FJ256GA110         Rev A
    Pumpkin JFPC-PIC24                                 Rev A
    Microchip MPLAB ICD 2 or equivalent

  Software:
    Pumpkin CubeSat Kit /PIC24                         1.2.4
    Pumpkin Salvo for PIC24/dsPIC                      4.2.2
    Pumpkin Library for PIC24                          1.0.2
    Microchip MPLAB C30 compiler (for PIC24/dsPIC)     3.2.3
    Microchip MPLAB IDE                                8.33
    
RECOMMENDED:

  Hardware:
    Pumpkin CubeSat Kit Test Board A (LED Module)      Rev B     

*******************************************************************************

DESCRIPTION:

This application is the standard test/validation software for Pumpkin CubeSat
Kits fitted with PPM D1 (PIC24FJ256GA110).

This application is built from a variety of sources and requires that all of 
the software listed above be installed. 

When running and connected as per the block diagram above, the user will be 
presented with three terminal screens:

  * J8: a user debug terminal, listing the actions the application is 
     taking, with timestamps in system ticks. This terminal accepts
     one-letter commands -- type 'h' for a help screen.
  * J2: a status display, with timestamps in system ticks, with an 
     informational message
  * MHX: a status display, with timestamps in ticks, with modem command
     strings and informational messages
     
This application runs multiple tasks and exercises the various parts of
the CubeSat Kit hardware architecture.  

The PPM D1 and D2 programs and projects are nearly identical because the 
PIC24 and dsPIC33 processors used in PPM D1 and D2 have similar basic 
functionality. The primary differences between the projects are:

  * each project is configured for the appropriate processor (PIC24 or dsPIC33)
  * the include path points to the project directory
  * each project has some a unique files in its project directory (e.g. config.h,
     main.h)
  * each project references either PIC24- or dsPIC33-specific CubeSat Kit and
     Pumpkin Library files
  * the PIC24 project runs with an 8.000MHz clock, and the dsPIC33 project with a 
     20.000MHz clock -- this affects e.g. the timer setup.
  * some features of the PIC24 (e.g., the ability to configure the WDT at runtime)
     do not exist on the dsPIC33.
  
  *******************************************************************************

NOTES:

1. This application is built with the Microchip MPLAB C Compiler for PIC24 MCUs
and dsPIC DSCs (also called MPLAB C30, P/N SW006012). It has _not_ been tested 
with either the MPLAB C Compiler for PIC24 MCUs only (P/N SW006014) or with the 
MPLAB C Compiler for dsPIC DSCs only (P/N SW006013). Other compilers (e.g., 
HI-TECH or IAR) are _not_ supported.

2. This application uses the Microchip PIC24F Peripheral Library (included with
MPLAB C30) for peripheral initialization, etc. The header files for this library
are normally installed as part of an MPLAB C30 installation. To ensure compatibility
with these projects, Pumpkin supplies a pre-compiled version of this library with
this distribution. It is located in PIC24\Lib and is referenced by this
application. You may need to rebuild this library (follow Microchip's instructions
and sample MPLAB project) if your compiler is substantially newer than this
release of the CubeSat Kit /PIC24 software.

3. Some early-production PPM D1 modules were delivered with 6.000MHz primary 
crystals. Normal production uses 8.000MHz crystals. If you have a PPM D1 with
a 6.000MHz crystal, change MAIN_XTAL_FREQ in this project's config.h to 6000000L.

4. task_usb_talk() reports an on-chip temperature of 0C because the PIC24 has no
on-chip temperature sensor.

5. You can run this application within the MPLAB SIM simulator -- output from
the CubeSat Kit's UART0 (e.g., J8 on the Dev Board) will appear in the SIM
Uart1 tab of MPLAB's Output window. When running inside the simulator, you
can e.g. measure the system timer tick period by placing a breakpoint on the
call to OSTimer() and measuring elapsed time with MPLAB SIM's Stopwatch.




